<% content_for :title, "Students" %>

<div class="max-w-6xl mx-auto p-6">
  <div class="bg-white rounded-lg shadow-md">
    <!-- Header -->
    <div class="px-6 py-4 border-b border-gray-200">
      <div class="flex justify-between items-center">
        <h1 class="text-2xl font-bold text-gray-900">Students</h1>
        <%= link_to 'New Student', new_student_path, 
            class: "bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors" %>
      </div>
    </div>

    <!-- Content -->
    <div class="p-6">
      <% if @students.any? %>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Student
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  ID
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Email
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Sections
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Actions
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <% @students.each do |student| %>
                <tr class="hover:bg-gray-50">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <%= link_to student_path(student), 
                        class: "text-blue-600 hover:text-blue-800" do %>
                      <div class="font-medium text-gray-900">
                        <%= student.last_name %>, <%= student.first_name %>
                      </div>
                    <% end %>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    <%= student.student_id %>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    <%= mail_to student.email, student.email, 
                        class: "text-blue-600 hover:text-blue-800" %>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    <% if student.sections.any? %>
                      <div class="space-y-1">
                        <% student.sections.includes(course: :prefix).each do |section| %>
                          <div class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded inline-block mr-1">
                            <%= section.course.prefix.code %> <%= section.course.number %> - <%= section.name %>
                          </div>
                        <% end %>
                      </div>
                    <% else %>
                      <span class="text-gray-400">Not enrolled</span>
                    <% end %>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm space-x-2">
                    <%= link_to 'View', student_path(student), 
                        class: "text-blue-600 hover:text-blue-800" %>
                    <%= link_to 'Edit', edit_student_path(student), 
                        class: "text-yellow-600 hover:text-yellow-800" %>
                    <%= link_to 'Delete', student_path(student), method: :delete,
                        confirm: 'Are you sure?',
                        class: "text-red-600 hover:text-red-800" %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      <% else %>
        <div class="text-center py-12">
          <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.125 0A17.502 17.502 0 0012 3c-2.998 0-5.814.75-8.125 2.047M15 21v-1a6 6 0 00-6-6H9a6 6 0 00-6 6v1h12z" />
          </svg>
          <h3 class="mt-2 text-sm font-medium text-gray-900">No students</h3>
          <p class="mt-1 text-sm text-gray-500">Get started by creating a new student.</p>
          <div class="mt-6">
            <%= link_to 'New Student', new_student_path, 
                class: "bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>